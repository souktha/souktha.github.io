<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<base href="http://souktha.github.io/hardware/cyclic_1_x_x4_hw/">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Simple Cyclic Hamming (15,11,3) FEC | Soukthavy Sopha</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://souktha.github.io/hardware/cyclic_1_x_x4_hw/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Soukthavy">
<link rel="prev" href="../../misc/cyclic_1_x_x4/" title="Simple Cyclic Hamming codes" type="text/html">
<meta property="og:site_name" content="Soukthavy Sopha">
<meta property="og:title" content="Simple Cyclic Hamming (15,11,3) FEC">
<meta property="og:url" content="http://souktha.github.io/hardware/cyclic_1_x_x4_hw/">
<meta property="og:description" content="This post is the implementation part of the my post on simple cyclic Hamming code
where I did some math workout on this type of forward error-correction code (FEC). I am doing
it for fun since I think">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-12-22T00:17:42Z">
<meta property="article:tag" content="hardware">
<meta property="article:tag" content="latex">
<meta property="article:tag" content="mathjax">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://souktha.github.io/">

                <span id="blog-title">Soukthavy Sopha</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>
            </li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Blog <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../../software">Sofware</a>
                    </li>
<li>
<a href="../../hardware">Hardware</a>
                    </li>
<li>
<a href="../../misc">Misc</a>
            </li>
</ul>
</li>
<li>
<a href="https://github.com/souktha">My Github</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Simple Cyclic Hamming (15,11,3) FEC</a></h1>

        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>This post is the implementation part of the my post on <a class="reference external" href="http://souktha.github.io/misc/cyclic_1_x_x4">simple cyclic Hamming code</a>
where I did some math workout on this type of forward error-correction code (FEC). I am doing
it for fun since I think it is simple enough to implement it in FPGA. The generator
for this exercise is <span class="math">\(g(x)=1+x+x4\)</span> for an <span class="math">\((n,k,d) \equiv (15,11,3)\)</span> code.</p>
<!-- TEASER_END -->
<div class="section" id="implementation">
<h2>Implementation</h2>
<p>If the data to be encoded is parallel data block, the encoded message can simply be done with
simple combinational logic based on the <span class="math">\(G\)</span> matrix, likewise for the decoder logic, but
this is too boring. I choose to complicate this matter by assuming that the input data bits
to be encoded or decoded arrive serially, perhaps from a transceiver part of the circuit. This
way I can implement it with divider circuit and get myself frustrated with timing closure and
everything else. Simple and elegant way is not always paid off. This is what I am going to do.</p>
<p>For this exercise, I am targeting the Xilinx Artix FPGA device. I create three verilog modules,</p>
<p>. Encoder for encoding 11-bit message to 15-bit message.</p>
<p>. Decoder for decoding the 15-bit receiving message.</p>
<p>. Corrector is for correcting the error if syndrome indicates the error.</p>
<div class="section" id="the-encoder">
<h3>The encoder</h3>
<p>The encoder takes a stream of 11-bit input message and encodes it to 15-bit messages in
systematic form. The input bit is clocked in bit-by-bit to the encoder whenever <em>enc_enable</em>
is asserted. On the completion of the encoding process, the <em>rdy</em> is asserted as an output
ready indicator so that the 15-bit encoded message can be read.</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-1"> 1</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-2"> 2</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-3"> 3</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-4"> 4</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-5"> 5</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-6"> 6</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-7"> 7</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-8"> 8</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-9"> 9</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-10">10</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-11">11</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-12">12</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-13">13</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-14">14</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-15">15</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-16">16</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-17">17</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-18">18</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-19">19</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-20">20</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-21">21</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-22">22</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-23">23</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-24">24</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-25">25</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-26">26</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-27">27</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-28">28</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-29">29</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-30">30</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-31">31</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-32">32</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-33">33</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-34">34</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-35">35</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-36">36</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-37">37</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-38">38</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-39">39</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-40">40</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-41">41</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-42">42</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-43">43</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-44">44</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-45">45</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-46">46</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-47">47</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-48">48</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-49">49</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-50">50</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-51">51</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-52">52</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-53">53</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-54">54</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-55">55</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-56">56</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-57">57</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-58">58</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-59">59</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-60">60</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-61">61</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-62">62</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-63">63</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-64">64</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-65">65</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-66">66</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-67">67</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-68">68</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-69">69</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-70">70</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-71">71</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-72">72</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-73">73</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-74">74</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-75">75</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-76">76</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-77">77</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-78">78</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-79">79</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-80">80</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-81">81</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-82">82</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-83">83</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-84">84</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-85">85</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-86">86</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-87">87</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-88">88</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-89">89</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-90">90</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-91">91</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-92">92</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-93">93</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-94">94</a>
<a href="#rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-95">95</a></pre></div></td>
<td class="code"><pre class="code verilog"><a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-1"></a>     <span class="cm">/*(n,k,d) = (15,11,3)</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-2"></a><span class="cm">     input is serialized 11 bits, output is 15 bits*/</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-3"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-4"></a>     <span class="k">module</span> <span class="n">cyclic_1_x_x4_encode</span> <span class="p">#(</span><span class="k">parameter</span> <span class="no">IWIDTH</span><span class="o">=</span><span class="mh">11</span><span class="p">,</span> <span class="no">OWIDTH</span><span class="o">=</span><span class="mh">15</span><span class="p">)</span> <span class="p">(</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-5"></a>         <span class="k">input</span> <span class="n">clk</span><span class="p">,</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-6"></a>         <span class="k">input</span> <span class="n">enc_enable</span><span class="p">,</span> <span class="c1">//enable encoder</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-7"></a>         <span class="k">output</span> <span class="n">bsy</span><span class="p">,</span> <span class="c1">// state of encoder</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-8"></a>         <span class="k">output</span> <span class="n">rdy</span><span class="p">,</span> <span class="c1">// 1 when decoded data is ready for reading.</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-9"></a>         <span class="k">input</span>  <span class="n">ibit</span><span class="p">,</span> <span class="c1">//serialize input bit input code word</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-10"></a>         <span class="k">output</span> <span class="p">[</span><span class="no">OWIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">codeword</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-11"></a>         <span class="p">);</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-12"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-13"></a>         <span class="kt">reg</span> <span class="p">[</span><span class="no">OWIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">cw</span> <span class="o">=</span> <span class="mh">15'h0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-14"></a>         <span class="kt">reg</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span> <span class="c1">//quotient and remainder</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-15"></a>         <span class="kt">reg</span> <span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">count</span> <span class="o">=</span> <span class="mh">4'h0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-16"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-17"></a>         <span class="kt">reg</span> <span class="n">busy</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">'b1</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-18"></a>         <span class="kt">reg</span> <span class="n">ready</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">'b0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-19"></a>         <span class="kt">wire</span> <span class="n">fbypass</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-20"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-21"></a>         <span class="k">assign</span> <span class="n">rdy</span> <span class="o">=</span> <span class="n">ready</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-22"></a>         <span class="k">assign</span> <span class="n">bsy</span> <span class="o">=</span> <span class="n">busy</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-23"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-24"></a>         <span class="k">assign</span> <span class="n">codeword</span> <span class="o">=</span> <span class="n">cw</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-25"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-26"></a>         <span class="k">initial</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-27"></a>             <span class="n">q</span> <span class="o">=</span> <span class="mh">4</span><span class="mb">'b0000</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-28"></a>             <span class="n">r</span> <span class="o">=</span> <span class="mh">4</span><span class="mb">'b0000</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-29"></a>             <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-30"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-31"></a>         <span class="cm">/*start bit counting process if busy*/</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-32"></a>         <span class="k">always</span><span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">)</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-33"></a>             <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">enc_enable</span> <span class="p">)</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-34"></a>                 <span class="n">count</span> <span class="o">&lt;=</span> <span class="mh">5'h0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-35"></a>             <span class="k">else</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-36"></a>             <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&lt;=</span> <span class="no">`NSHIFTS</span> <span class="p">)</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-37"></a>                 <span class="n">count</span> <span class="o">&lt;=</span> <span class="n">count</span> <span class="o">+</span> <span class="mh">1</span><span class="mb">'b1</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-38"></a>             <span class="k">else</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-39"></a>                 <span class="n">count</span> <span class="o">&lt;=</span> <span class="mh">5'h0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-40"></a>             <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-41"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-42"></a>         <span class="k">assign</span> <span class="n">fbypass</span> <span class="o">=</span> <span class="p">(</span><span class="n">count</span> <span class="o">&lt;=</span> <span class="no">`KBITS</span><span class="p">);</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-43"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-44"></a>         <span class="k">always</span><span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span> <span class="p">)</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-45"></a>             <span class="k">if</span> <span class="p">(</span> <span class="n">enc_enable</span> <span class="p">)</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-46"></a>                 <span class="k">if</span> <span class="p">(</span> <span class="n">count</span> <span class="o">==</span> <span class="mh">5'h0</span>  <span class="p">)</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-47"></a>                     <span class="n">busy</span> <span class="o">&lt;=</span> <span class="p">#</span><span class="mh">1</span> <span class="mh">1</span><span class="mb">'b0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-48"></a>                     <span class="n">ready</span> <span class="o">&lt;=</span> <span class="p">#</span><span class="mh">1</span> <span class="mh">1</span><span class="mb">'b0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-49"></a>                 <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-50"></a>                 <span class="k">else</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-51"></a>                     <span class="k">if</span> <span class="p">(</span> <span class="n">fbypass</span>  <span class="p">)</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-52"></a>                                     <span class="cm">/*pass through k bits of message*/</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-53"></a>                         <span class="n">busy</span> <span class="o">&lt;=</span> <span class="p">#</span><span class="mh">1</span> <span class="mh">1</span><span class="mb">'b1</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-54"></a>                         <span class="n">ready</span> <span class="o">&lt;=</span> <span class="p">#</span><span class="mh">1</span> <span class="mh">1</span><span class="mb">'b0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-55"></a>                         <span class="n">cw</span> <span class="o">&lt;=</span> <span class="p">{</span><span class="n">cw</span><span class="p">[</span><span class="no">OWIDTH</span><span class="o">-</span><span class="mh">2</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="n">ibit</span><span class="p">};</span> <span class="c1">//left shift to MSB begin with 1st bit</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-56"></a>                         <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-57"></a>                     <span class="k">else</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-58"></a>                         <span class="n">cw</span> <span class="o">&lt;=</span> <span class="p">{</span><span class="n">cw</span><span class="p">[</span><span class="no">OWIDTH</span><span class="o">-</span><span class="mh">2</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="n">q</span><span class="p">[</span><span class="mh">3</span><span class="p">]};</span> <span class="c1">//concat parity bits to form coded word</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-59"></a>                         <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&gt;=</span> <span class="no">`NBITS</span><span class="p">)</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-60"></a>                          <span class="n">busy</span> <span class="o">&lt;=</span> <span class="p">#</span><span class="mh">1</span> <span class="mh">1</span><span class="mb">'b0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-61"></a>                          <span class="n">ready</span> <span class="o">&lt;=</span> <span class="p">#</span><span class="mh">1</span> <span class="mh">1</span><span class="mb">'b1</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-62"></a>                         <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-63"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-64"></a>                         <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-65"></a>                 <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-66"></a>             <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-67"></a>             <span class="k">else</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-68"></a>                 <span class="n">cw</span> <span class="o">&lt;=</span> <span class="mh">15'h0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-69"></a>                 <span class="n">busy</span> <span class="o">&lt;=</span> <span class="p">#</span><span class="mh">1</span> <span class="mh">1</span><span class="mb">'b0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-70"></a>                 <span class="n">ready</span> <span class="o">&lt;=</span> <span class="p">#</span><span class="mh">1</span> <span class="mh">1</span><span class="mb">'b0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-71"></a>                 <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-72"></a>         <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-73"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-74"></a>         <span class="cm">/*encoder for generator g(x) = 1 + x + x**4*/</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-75"></a>         <span class="k">always</span><span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">)</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-76"></a>             <span class="k">if</span> <span class="p">(</span><span class="n">enc_enable</span><span class="p">)</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-77"></a>                 <span class="n">q</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span> <span class="o">&lt;=</span>  <span class="n">q</span><span class="p">[</span><span class="mh">2</span><span class="p">];</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-78"></a>                 <span class="n">q</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">&lt;=</span>  <span class="n">q</span><span class="p">[</span><span class="mh">1</span><span class="p">];</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-79"></a>                 <span class="k">if</span> <span class="p">(</span> <span class="n">fbypass</span> <span class="p">)</span>  <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-80"></a>                     <span class="n">q</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&lt;=</span>  <span class="n">q</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span> <span class="o">^</span> <span class="n">q</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">ibit</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-81"></a>                     <span class="n">q</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&lt;=</span>  <span class="n">ibit</span> <span class="o">^</span> <span class="n">q</span><span class="p">[</span><span class="mh">3</span><span class="p">];</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-82"></a>                 <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-83"></a>                 <span class="k">else</span> <span class="k">begin</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-84"></a>                     <span class="n">q</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">q</span><span class="p">[</span><span class="mh">0</span><span class="p">];</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-85"></a>                     <span class="n">q</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mh">1</span><span class="mb">'b0</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-86"></a>                     <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-87"></a>                 <span class="k">if</span> <span class="p">(</span> <span class="n">count</span> <span class="o">==</span> <span class="mh">5'h0</span> <span class="p">)</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-88"></a>                     <span class="n">q</span> <span class="o">&lt;=</span> <span class="mh">4</span><span class="mb">'b0000</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-89"></a>             <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-90"></a>             <span class="k">else</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-91"></a>                 <span class="n">q</span> <span class="o">&lt;=</span> <span class="mh">4</span><span class="mb">'b0000</span><span class="p">;</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-92"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-93"></a>         <span class="k">end</span>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-94"></a>
<a name="rest_code_5d30ffec1b1b4dd4b7cf1553ce84c456-95"></a>     <span class="k">endmodule</span>
</pre></td>
</tr></table>
<p>The interface part of this module is between line 44-72. The divider circuit that forms the <span class="math">\(P_i\)</span> bits is between line 75-93.
The lines that forms the output coded word are at line 55 and 58. The sample simulation below shows one of the encoded message.
Any <span class="math">\(2^{11}\)</span> input message words can be encoded by this circuit and matches with the multiplication of the
<span class="math">\(G\)</span> matrix. This is how I know that the divider circuit works.</p>
<div class="figure">
<img alt="../../images/hardware/encode_h1.jpg" src="../../images/hardware/encode_h1.jpg"><p class="caption">Fig1: encoded message 01h</p>
</div>
</div>
<div class="section" id="the-decoder-and-fec">
<h3>The decoder and FEC</h3>
<p><em>to be completed</em></p>
</div>
</div>
</div>
    </div>
    
            <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script><script type="text/x-mathjax-config">
            MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
            </script></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2016         <a href="mailto:soukthavy@yahoo.com">Soukthavy</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
